<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Stellar Blade Checklist</title>

<style>
:root {
  /* Core Colors*/
  --background: #141414;
  --card: #1E1E1E;
  --card-inlay: #1a1a1a;
  --button: #262626;
  --hover: #383838;
  --border: #222;
  --radius: 8px;
  
  /* Fonts */
  --font-main: Arial, sans-serif;
  --font-size-small: 14px;
  --font-size-medium: 16px;
  --font-size-large: 18px;
  --font-size-extra-large: 24px;

  /* Text Colors */
  --text: #fff;
  --text-muted: #999;

  /* Status Colors */
  --status-completed: #278041;
  --status-inprogress: #1177a3;
  --status-notstarted: #616161;
  --status-onhold: #a62327;
  --status-hundred: #689a2e;
  --progressbar: #4caf50;
  --status-text: var(--text);
  
  /* Tag Colors */
  --tag-required: #1177a3;
  --tag-optional: #616161;
  
  --tag-pistol: #2979ff;
  --tag-melee: #d32f2f;
  --tag-rifle: #388e3c;
  --tag-shotgun: #ff9800;
  --tag-energy: #00acc1;
  --tag-cannon: #7b1fa2;
  
  --tag-dlc: #c51162;
  
  --tag-Xion: #023570;
  --tag-Eidos7: #890125;
  --tag-Wasteland: #e25509;
  --tag-Matrix11: #1eaa0b;
  --tag-GreatDesert: #b23c05;
  --tag-Spire4: #e21474;
}

body {
  margin: 0;
  margin-bottom: 120px;
  background: var(--background);
  font-family: var(--font-main);
  color: var(--text);
}

/* Navigation */
.navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 40px;
  border-bottom: 1px solid var(--border);
}
.navbar .logo { font-size: var(--font-size-extra-large); font-weight: bold;}
.navbar .menu { display: flex; gap: 30px; }
.navbar .menu a {
  color: var(--text-muted);
  text-decoration: none;
  font-size: var(--font-size-medium);
  cursor: pointer;
}
.navbar .menu a.active { color: var(--text); }

/* Layout */
.container {
  max-width: 1920px;
  width: 100%;
  margin: 60px auto 0;
  padding: 0 20px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 25px;
  margin-top: 30px;
}
.grid2 {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 25px;
  margin-top: 30px;
}

/* Cards */
.card {
  background: var(--card);
  padding: 20px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  box-shadow: 0 3px 10px rgba(0,0,0,0.06);
}
.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  gap: 10px;
}
.card-header h3 {
  margin: 0;
  font-size: var(--font-size-large);
}

/* Charts */
.chart-status,
.chart-platform,
.card canvas {
  display: block;
  margin: 0 auto;
  width: 100% !important;
  max-height: 250px;
}

.games { grid-column: span 2; }

/* Buttons */
.button-report,
.button-delete svg {
  background: var(--button);
  padding: 6px 12px;
  border-radius: var(--radius);
  font-size: var(--font-size-small);
  cursor: pointer;
  color: var(--text);
  display: inline-flex;
  align-items: center;
  gap: 8px;
}
.button-report:hover,
.button-delete svg:hover {
  background: var(--hover);
}

/* Table */
table { width: 100%; border-collapse: collapse; }
table td, table th {
  padding: 12px 6px;
  border-bottom: 1px solid var(--border);
  font-size: var(--font-size-small);
}
table th { color: var(--text-muted); text-align: left; }

/* Lists */
ul { padding-left: 20px; }
ul li { margin-bottom: 8px; font-size: var(--font-size-medium); }

/* Scroll */
.scrollable-list-small,
.scrollable-list-large {
  margin-top: 12px;
  overflow-y: auto;
  padding-right: 8px;
  scrollbar-color: var(--hover) var(--card-inlay);
}
.scrollable-list-small { max-height: 160px; }
.scrollable-list-large { max-height: 400px; }

#gameSearch { padding:6px; width:300px; border-radius: var(--radius); border:1px solid var(--border); background: var(--card-inlay); color: var(--text); font-size:var(--font-size-small); }

/* Selects */
.statusSelect {
  padding: 6px 12px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  font-size: var(--font-size-small);
  background: var(--button);
  color: var(--text-muted);
}

.statusSelect {
  color: var(--status-text);
}

/* Status Colors */
.statusNotStarted { background: var(--status-notstarted); }
.statusInProgress { background: var(--status-inprogress); }
.statusCompleted { background: var(--status-completed); }
.statusOnHold { background: var(--status-onhold); }
.statusHundred { background: var(--status-hundred); }

/* Notes */
.note { 
  padding: 6px 12px;
  border-radius: var(--radius);
  font-size: var(--font-size-small);
  color:#aaa; 
  background:#1a1a1a; 
  margin-top:8px; 
  margin-bottom:8px; 
  display: block;
  width: fit-content;
  max-width: 100%;
  word-wrap: break-word;
}

/* Tags */
.tag {
  padding: 4px 8px;
  border-radius: var(--radius);
  font-size: var(--font-size-small);
}

/* Tag Colors */
.tag.Required {
  background: var(--tag-required);
  color: var(--status-text);
}

.tag.Optional {
  background: var(--tag-optional);
  color: var(--status-text);
}

.tag.Pistol {
  background: var(--tag-pistol);
  color: var(--status-text);
}

.tag.Melee {
  background: var(--tag-melee);
  color: var(--status-text);
}

.tag.Rifle {
  background: var(--tag-rifle);
  color: var(--status-text);
}

.tag.Shotgun {
  background: var(--tag-shotgun);
  color: var(--status-text);
}

.tag.Energy {
  background: var(--tag-energy);
  color: var(--status-text);
}

.tag.Cannon {
  background: var(--tag-cannon);
  color: var(--status-text);
}

/*#c9daf8*/
.tag.Xion {
   background: var(--tag-Xion);
   color: var(--status-text);
}

.tag.Eidos7 {
   background: var(--tag-Eidos7);
   color: var(--status-text);
}

.tag.Wasteland {
   background: var(--tag-Wasteland);
   color: var(--status-text);
}

.tag.Matrix11 {
   background: var(--tag-Matrix11);
   color: var(--status-text);
}

.tag.GreatDesert {
  background: var(--tag-GreatDesert);
  color: var(--status-text);
}

.tag.Spire4 {
  background: var(--tag-Spire4);
  color: var(--status-text);
}

.tag.DLC {
  background: var(--tag-dlc);
  color: var(--status-text);
}

/* Progress Bar */
.progress-bar {
  background: var(--card-inlay);
  width: 100%;
  height: 8px;
  border-radius: 4px;
  overflow: hidden;
  margin-top: 10px;
}
.progress-bar-fill {
  background: var(--progressbar);
  height: 100%;
  width: 0%;
  transition: width 0.4s ease;
}

/* Modal */
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
  z-index: 40;
}
.modal-content {
  background: var(--card);
  padding: 20px;
  border-radius: var(--radius);
  width: 320px;
  max-width: 95%;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.modal-content select,
.modal-content button {
  padding: 8px;
  border-radius: var(--radius);
  border: none;
  font-size: var(--font-size-small);
  background: var(--button);
  color: var(--text);
}
#closeModal { background: var(--button); }

/* Cerulean Theme */
body.alt-theme {
  /* Core Colors */
  --background: #0F1C23;
  --card: #162933;
  --card-inlay: #13262C;
  --button: #1D3B48;
  --hover: #2A4F63;
  --border: #1A3642;
  --radius: 8px;

  /* Text Colors */
  --text: #fff;
  --text-muted: #999;
  
  /* Status Colors */
  --status-text: var(--text);
}

/* Scandi Theme */
body.scandi-theme {
  /* Core Colors */
  --background: #efe8dd;
  --card: #cab3a0;
  --card-inlay: #decabd;
  --button: #decabd;
  --hover: #edeae5;
  --border: #decabd;
  --radius: 8px;

  /* Text Colors */
  --text: #434341;
  --text-muted: #373A3A;
  
  /* Status Colors */
  --status-text: var(--hover);
}

/* Scandi Theme */
body.discord-theme {
  /* Core Colors */
  --background: #121214;
  --card: #1A1A1E;
  --card-inlay: #17171B;
  --button: #212125;
  --hover: #323235;
  --border: #222;
  --radius: 8px;

  /* Text Colors */
  --text: #fff;
  --text-muted: #999;
  
  /* Status Colors */
  --status-text: var(--text);
}

/* Responsive */
@media (max-width:900px){
  .grid { grid-template-columns: 1fr; }
  .games { grid-column: auto; }
}

#importBtn .material-symbols-outlined {
  font-size: 18px;
  vertical-align: middle;
  line-height: 0;
}

#exportBtn .material-symbols-outlined {
  font-size: 18px;
  vertical-align: middle;
  line-height: 0;
}

.card .material-symbols-outlined {
  font-size: 24px;
  vertical-align: bottom;
  line-height: 1;
}

.menu .material-symbols-outlined {
  font-size: 24px;
  vertical-align: middle;
  line-height: 0;
}

</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=add,check,delete,download,list,progress_activity,settings,upload" />
</head>

<body>

<div class="navbar">
  <div class="logo">.checklist</div>
  <div class="menu">
    <a class="active" href="#">Dashboard</a>
    <a href="#">Stats</a>
    <a href="#" id="openSettingsModal">Settings</a>
  </div>
  <div class="logo">/stellar-blade</div>
</div>

<div class="container">
  <!-- Dashboard content -->
  <div id="dashboardContent">
  <h1>Dashboard</h1>
      <div class="grid">
      <div class="card">
        <div class="card-header"><h3><span class="material-symbols-outlined">check</span> Recently Completed</h3></div>
        <div class="scrollable-list-small" id="recentlyPlayed"></div>
      </div>

      <div class="card">
        <div class="card-header"><h3><span class="material-symbols-outlined">progress_activity</span> In Progress</h3></div>
        <div class="scrollable-list-small" id="inProgress"></div>
      </div>

      <div class="card">
        <div class="card-header"><h3><span class="material-symbols-outlined">list</span> Summary</h3></div>
        <ul id="summary"></ul>
      </div>
      
            <div class="card games">
        <div class="card-header">
          <h3>Stellar Blade Checklist</h3>
          <span class="button-report" id="exportBtn">          
           <span class="material-symbols-outlined">download</span>Export
          </span>
          
          <span class="button-report" id="importBtn">
           <span class="material-symbols-outlined">upload</span>Import
          </span>
          
          <input type="file" id="importJSON" accept=".json" style="display:none;">
          <input type="text" id="gameSearch" placeholder="Search...">
        </div>
       
       <span class="button-report" data-cat="main">Main Quests</span>
       <span class="button-report" data-cat="side">Side Quests</span>
       <span class="button-report" data-cat="request">Requests</span>
       <span class="button-report" data-cat="can">Cans</span>
       
        <div class="scrollable-list-large">
        <ul id="questCategoryContainer"></ul>
          <table id="questsTable">
            <thead>
              <tr>
                <th>Name</th>
                <th>Category</th>
                <th>Type</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      
      <div class="card" style="max-height:120px">
        <div class="card-header"><h3>Completion Goal</h3></div>
        <div class="completion-goal" id="completionText"></div>
        <div class="progress-bar">
          <div class="progress-bar-fill" id="completionBar"></div>
        </div>
      </div>
    </div>
  </div>
  
    <!-- Stats content -->
  <div id="statsContent" style="display:none;">
    <h1>Game Stats</h1>
    <div class="grid2">
      <div class="card" style="max-height:360px">
        <div class="card-header"><h3>Overall Status</h3></div>
        <canvas id="categoryChart" class="chart-status"></canvas>
      </div>
      <div class="card" style="max-height:120px">
        <div class="card-header"><h3>Completion Goal</h3></div>
        <div class="completion-goal" id="completionTextStats"></div>
        <div class="progress-bar">
      		<div class="progress-bar-fill" id="completionBarStats"></div>
       </div>
      </div>
    </div>
  </div>
</div>

<!-- Settings Modal -->
<div id="settingsModal" class="modal">
  <div class="modal-content">
    <h3>Settings</h3>

    <h4>Choose Theme</h4>
    <button class="theme-btn" data-theme="default">Woodsmoke</button>
    <button class="theme-btn" data-theme="alt">Cerulean</button>
    <button class="theme-btn" data-theme="scandi">Scandi</button>
    <button class="theme-btn" data-theme="discord-dark">Discord Dark</button>

    <button id="closeSettingsModal">Close</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
/*----------- stats ----------*/
let categoryChart;

function updateStats() {

  // Helper: calculate completion %
  function completionPercent(list) {
    let completed = 0;

    list.forEach(q => {
      if (q.status === "Completed" || q.status === "Hundred") {
        completed++;
      }
    });

    return list.length
      ? Math.round((completed / list.length) * 100)
      : 0;
  }

  /* -------- CATEGORY DATA -------- */
  const categoryLabels = [
    "Main Quests", 
    "Side Quests", 
    "Requests",
    "Cans"
  ];

  const categoryValues = [
    completionPercent(quests.main),
    completionPercent(quests.side),
    completionPercent(quests.request),
    completionPercent(quests.can)
  ];

  /* -------- Chart setup -------- */
  const ctx = document.getElementById("categoryChart")?.getContext("2d");
  if (!ctx) return;

  const cardInlay = getComputedStyle(document.documentElement)
    .getPropertyValue("--card-inlay")
    .trim();

  const textColor = getComputedStyle(document.documentElement)
    .getPropertyValue("--text")
    .trim();

  Chart.defaults.color = textColor;

  if (categoryChart) categoryChart.destroy();

  categoryChart = new Chart(ctx, {
    type: "bar",
    data: {
      labels: categoryLabels,
      datasets: [{
        label: "Completion %",
        data: categoryValues,
        backgroundColor: "#1177a3"
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: true,
          max: 100,
          ticks: {
            callback: v => v + "%"
          }
        }
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            label: ctx => ctx.parsed.y + "%"
          }
        }
      }
    },
    plugins: [{
      beforeDraw: chart => {
        const ctx = chart.ctx;
        ctx.save();
        ctx.fillStyle = cardInlay;
        ctx.fillRect(0, 0, chart.width, chart.height);
        ctx.restore();
      }
    }]
  });
}

/* -----------------------
   HARD-CODED QUEST DATA
   ----------------------- */
const quests = {
  main: [
    { name: "7th Airborne Squad", tag: "Required", status: "NotStarted", note: ""},
    { name: "Scavenger Adam", tag: "Required", status: "NotStarted", note: ""},
    { name: "Xion, the Last Remaining City", tag: "Required", status: "NotStarted", note: ""},
    { name: "Altess Levoire", tag: "Required", status: "NotStarted", note: ""},
    { name: "Light of Hope", tag: "Required", status: "NotStarted", note: ""},
    { name: "Alpha Signal", tag: "Required", status: "NotStarted", note: ""},
    { name: "Hidden Truth", tag: "Required", status: "NotStarted", note: ""},
    { name: "Abyss Levoire", tag: "Required", status: "NotStarted", note: ""},
    { name: "Orcal's Testimony", tag: "Required", status: "NotStarted", note: ""},
    { name: "Secret Garden", tag: "Required", status: "NotStarted", note: ""},
    { name: "Eye of the Hurricane", tag: "Required", status: "NotStarted", note: ""},
    { name: "Burning Xion", tag: "Required", status: "NotStarted", note: ""},
    { name: "Last Fragment", tag: "Required", status: "NotStarted", note: ""},
    { name: "Selection of Species", tag: "Required", status: "NotStarted", note: ""},
    { name: "EVE Protocol", tag: "Required", status: "NotStarted", note: ""}
  ],
  side: [
    { name: "A Treasure with a Name", tag: "Optional", status: "NotStarted", note: ""},
    { name: "A United People Cannot Be Defeated", tag: "Optional", status: "NotStarted", note: ""},
    { name: "An Eye for an Eye, a Tooth for a Tooth", tag: "Optional", status: "NotStarted", note: ""},
    { name: "An Offer You Can't Refuse", tag: "Optional", status: "NotStarted", note: ""},
    { name: "An Unknown Present", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Angel of Death", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Barry and Wine", tag: "Optional", status: "NotStarted", note: ""},
    { name: "CnL - Communicate and Link", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Encounter", tag: "Optional", status: "NotStarted", note: ""},
    { name: "End of the Nightmare", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Fallen Angel", tag: "Optional", status: "NotStarted", note: ""},
    { name: "First Customer", tag: "Optional", status: "NotStarted", note: ""},
    { name: "I Won't Forget You", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Incarceration", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Keeping Secrets", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Let There Be Light Again", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Life of the Scavengers", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Looking at You", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Looking Glass", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Lost Ark", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Madama Machine", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Memories in the Doll", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Oblivion", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Plan to Clean the Earth", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Reboot!", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Reboot!!!", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Siren's Song", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Stolen Treasure", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Stubbornness", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Taboo", tag: "Optional", status: "NotStarted", note: ""},
    { name: "The King of the Tunnel", tag: "Optional", status: "NotStarted", note: ""},
    { name: "The Scavenger's Story", tag: "Optional", status: "NotStarted", note: ""},
    { name: "The Words of Mother Sphere", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Urgent Information", tag: "Optional", status: "NotStarted", note: ""}
  ],
  request: [
    { name: "An Unforgettable Fish Dish", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Find the Cat", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Generous Drop Pod", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Legion's Secret Stash", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Looking for My Brother", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Lost Device", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Lurker Hunt", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Missing Husband", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Missing Wife", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Precious Treasure", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Recruit Passcode Specialists", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Simple Puzzle", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Sleeping Beauty", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Source of the Nightmare", tag: "Optional", status: "NotStarted", note: ""},
    { name: "The Last Wine", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Time for Revenge", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Valuable Cargo", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Where's the Item", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Wife's Medicine", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Wife's Water Tank", tag: "Optional", status: "NotStarted", note: ""},
    { name: "Wisdom Puzzle", tag: "Optional", status: "NotStarted", note: ""}
  ],
  can: [
    { name: "Cryo Original", tag: "Eidos7", status: "NotStarted", note: ""},
    { name: "Cryo Zero", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Pixie", tag: "Xion", status: "NotStarted", note: ""},
    { name: "Pixie Zero", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Newfoundland Dry", tag: "Matrix11", status: "NotStarted", note: ""},
    { name: "Newfoundland Dry Zero", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Milky Pop", tag: "Spire4", status: "NotStarted", note: ""},
    { name: "Milky Pop Zero", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "The Machinetta Americano", tag: "Xion", status: "NotStarted", note: ""},
    { name: "The Machinetta Cafe Latte", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "The Machinetta Caramel Machiatto", tag: "Xion", status: "NotStarted", note: ""},
    { name: "Cryo Cafe Original", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Cryo Cafe Vanilla", tag: "Matrix11", status: "NotStarted", note: ""},
    { name: "Cryo Cafe Mocha", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "The Haven Earl Grey", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "The Haven Milk Tea", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "The Haven Green Tea", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "GrainT Barley", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "GrainT Oolong", tag: "Xion", status: "NotStarted", note: ""},
    { name: "GrainT Corn", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Nectar Orange", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Nectar Grape", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Nectar Apple", tag: "Spire4", status: "NotStarted", note: ""},
    { name: "Nectar Cranberry", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Elixir Carrot", tag: "Eidos7", status: "NotStarted", note: ""},
    { name: "Elixir Green", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Behemoth Red", tag: "Xion", status: "NotStarted", note: ""},
    { name: "Behemoth Green", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Behemoth Black", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Liquid Fire", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Liquid Lightning", tag: "Spire4", status: "NotStarted", note: ""},
    { name: "Liquid Nuclear", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Potential Blast", tag: "Eidos7", status: "NotStarted", note: ""},
    { name: "Potential Tempest", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Potential Frost", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Dionysus C", tag: "Xion", status: "NotStarted", note: ""},
    { name: "Moonwell", tag: "Spire4", status: "NotStarted", note: ""},
    { name: "Starwell", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Mountain Sparkle Mont Blanc", tag: "Xion", status: "NotStarted", note: ""},
    { name: "Mountain Sparkle Everest", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Mountain Sparkle Halla", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Cryo The Clear", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Cryo The Malt", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Bayern Hefe Weissbier", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Bayern Weissbier Dunkel", tag: "Xion", status: "NotStarted", note: ""},
    { name: "Corsair Lager", tag: "Wasteland", status: "NotStarted", note: ""},
    { name: "Corsair Ale", tag: "Matrix11", status: "NotStarted", note: ""},
    { name: "Johnson's Highball Lemon", tag: "GreatDesert", status: "NotStarted", note: ""},
    { name: "Johnson's Highball Ginger", tag: "GreatDesert", status: "NotStarted", note: ""}
  ]
};

let currentCategory = "main";

function renderTable() {
  const tbody = document.querySelector("#questsTable tbody");

  const recentList = document.getElementById('recentlyPlayed');
  const inProgressList = document.getElementById('inProgress');
  const summaryBox = document.getElementById('summary');
  const completionText = document.getElementById('completionText');
  const completionBar = document.getElementById('completionBar');
  const completionTextStats = document.getElementById('completionTextStats');
  const completionBarStats = document.getElementById('completionBarStats');

  recentList.innerHTML = '';
  inProgressList.innerHTML = '';
  summaryBox.innerHTML = '';

  let totalQuests = 0;
  let completed = 0;
  let inProgress = 0;
  let notStarted = 0;
  let onHold = 0;
  let hundred = 0;

  const recentFrag = document.createDocumentFragment();
  const inProgressFrag = document.createDocumentFragment();

  /* ---------------------------
      TABLE RENDER
  ---------------------------- */
tbody.innerHTML = quests[currentCategory].map((q, i) => {

  // FIX: convert tag string â†’ array inside the map
  const tags = Array.isArray(q.tag)
    ? q.tag
    : q.tag.split(",").map(t => t.trim());

  return `
    <tr>
      <td>
        <div>${q.name}</div> 
        ${q.note && q.note.trim() !== "" ? `<div class="note">${q.note}</div>` : ""}
      </td>
      <td>${currentCategory}</td>
      <td>
        ${tags.map(t => `
          <span class="tag ${t.replace(/\s+/g, '-')}" data-type="${t}">${t}</span>
        `).join("")}
      </td>
      <td>
        <select class="statusSelect status${q.status}" data-cat="${currentCategory}" data-index="${i}">
          <option value="NotStarted" ${q.status==="NotStarted"?"selected":""}>Not Started</option>
          <option value="InProgress" ${q.status==="InProgress"?"selected":""}>In Progress</option>
          <option value="OnHold" ${q.status==="OnHold"?"selected":""}>On Hold</option>
          <option value="Completed" ${q.status==="Completed"?"selected":""}>Completed</option>
          <option value="Hundred" ${q.status==="Hundred"?"selected":""}>100%</option>
        </select>
      </td>
    </tr>
  `;
}).join("");

  /* ---------------------------
      COUNT STATUSES
  ---------------------------- */
  quests[currentCategory].forEach(q => {
    totalQuests++;

    switch (q.status) {
      case "Completed":
        completed++;
        const r1 = document.createElement("li");
        r1.textContent = q.name;
        recentFrag.appendChild(r1);
        break;

      case "Hundred":
        hundred++;
        completed++;
        const r2 = document.createElement("li");
        r2.textContent = q.name + " (100%)";
        recentFrag.appendChild(r2);
        break;

      case "InProgress":
        inProgress++;
        const ip = document.createElement("li");
        ip.textContent = q.name;
        inProgressFrag.appendChild(ip);
        break;

      case "NotStarted":
        notStarted++;
        break;

      case "OnHold":
        onHold++;
        break;
    }
  });

  /* ---------------------------
      APPEND LISTS
  ---------------------------- */
  recentList.appendChild(recentFrag);
  inProgressList.appendChild(inProgressFrag);

  /* ---------------------------
      COMPLETION BAR
  ---------------------------- */
  let total = 0;
  let done = 0;

  // Count ALL quests across ALL categories
  Object.values(quests).forEach(category => {
    category.forEach(q => {
      total++;

      if (q.status === "Completed" || q.status === "Hundred") {
        done++;
      }
    });
  });

  const percent = total ? (done / total) * 100 : 0;

  // Dashboard bar
  if (completionBar) completionBar.style.width = percent + "%";
  if (completionText) completionText.textContent = `${done} / ${total} Completed`;

  // Stats page bar
  if (completionBarStats) completionBarStats.style.width = percent + "%";
  if (completionTextStats) completionTextStats.textContent = `${done} / ${total} Completed`;

  /* ---------------------------
      SUMMARY BOX
  ---------------------------- */
  if (summaryBox) {
    summaryBox.innerHTML = `
      <li>Total: ${totalQuests}</li>
      <li>100%: ${hundred}</li>
      <li>Completed: ${completed}</li>
      <li>In Progress: ${inProgress}</li>
      <li>Not Started: ${notStarted}</li>
      <li>On Hold: ${onHold}</li>
    `;
  }
}

// Update status when dropdown changes
document.addEventListener("change", e => {
  if (e.target.matches("select[data-cat]")) {
    const cat = e.target.dataset.cat;
    const index = e.target.dataset.index;
    quests[cat][index].status = e.target.value;
    localStorage.setItem("stellar-blade-checklist", JSON.stringify(quests));
    renderTable();
  }
});

/* ---------- Search ---------- */
const searchInput = document.getElementById('gameSearch');

searchInput.addEventListener('input', () => {
  const query = searchInput.value.toLowerCase();
  const tbody = document.querySelector('#questsTable tbody');

  Array.from(tbody.querySelectorAll('tr')).forEach(row => {
    const title = row.cells[0]?.textContent.toLowerCase() || '';
    const tags = row.cells[2]?.textContent.toLowerCase() || '';

    // safe access to selects (may be missing in some row types)
    const statusSelect = row.cells[3]?.querySelector('select');

    const statusVal = (statusSelect?.value || '').toLowerCase();
    // human-friendly label for matching (so "hundred" matches "100%")
    let statusLabel = statusVal;
    if (statusVal === 'hundred') statusLabel = '100%';
    if (statusVal === 'inprogress') statusLabel = 'in progress';
    if (statusVal === 'notstarted') statusLabel = 'not started';
    if (statusVal === 'onhold') statusLabel = 'on hold';
    if (statusVal === 'completed') statusLabel = 'completed';

    const match =
      title.includes(query) ||
      statusVal.includes(query) ||
      statusLabel.includes(query) ||
      tags.includes(query);

    row.style.display = match ? '' : 'none';
  });
});

/* ---------- theme handling -----------*/
const SettingsModal = document.getElementById("settingsModal");
const openSettings = document.getElementById("openSettingsModal");
const closeSettings = document.getElementById("closeSettingsModal");

// Open modal
openSettings.addEventListener("click", (e) => {
  e.preventDefault();
  SettingsModal.style.display = "flex";
});

// Close modal
closeSettings.addEventListener("click", () => {
  SettingsModal.style.display = "none";
});

// Click outside modal closes it
SettingsModal.addEventListener("click", (e) => {
  if (e.target === SettingsModal) SettingsModal.style.display = "none";
});

// Theme buttons
document.querySelectorAll(".theme-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    const theme = btn.dataset.theme;

    if (theme === "alt") {
      document.body.classList.add("alt-theme");
    } else {
      document.body.classList.remove("alt-theme");
    }
    
    if (theme === "scandi") {
      document.body.classList.add("scandi-theme");
    } else {
      document.body.classList.remove("scandi-theme");
    }

    if (theme === "discord-dark") {
      document.body.classList.add("discord-theme");
    } else {
      document.body.classList.remove("discord-theme");
    }

    localStorage.setItem("theme", theme);
  });
});

// Load saved theme
if (localStorage.getItem("theme") === "alt") {
  document.body.classList.add("alt-theme");
}

if (localStorage.getItem("theme") === "scandi") {
  document.body.classList.add("scandi-theme");
}

if (localStorage.getItem("theme") === "discord-dark") {
  document.body.classList.add("discord-theme");
}

/* ---------- tab handling -----------*/
const dashboardContent = document.getElementById('dashboardContent');
const statsContent = document.getElementById('statsContent');

const menuLinks = document.querySelectorAll('.navbar .menu a');
const dashboardLink = [...menuLinks].find(a => a.textContent.trim() === 'Dashboard');
const statsLink = [...menuLinks].find(a => a.textContent.trim() === 'Stats');

function showDashboard() {
  dashboardContent.style.display = 'block';
  statsContent.style.display = 'none';
  dashboardLink.classList.add('active');
  statsLink.classList.remove('active');
}

function showStats() {
  dashboardContent.style.display = 'none';
  statsContent.style.display = 'block';
  statsLink.classList.add('active');
  dashboardLink.classList.remove('active');
  updateStats();
}

dashboardLink.addEventListener('click', e => { e.preventDefault(); showDashboard(); });
statsLink.addEventListener('click', e => { e.preventDefault(); showStats(); });

// Save/load progress
const saved = JSON.parse(localStorage.getItem("stellar-blade-checklist"));
if (saved) Object.assign(quests, saved);

// Handle category buttons
document.querySelectorAll(".button-report[data-cat]").forEach(btn => {
  btn.addEventListener("click", () => {
    currentCategory = btn.dataset.cat;
    renderTable();
  });
});

/* ---------- init ---------- */
renderTable();
</script>

</body>
</html>
